"use strict";(self.webpackChunkuse_docusaurus_github_io=self.webpackChunkuse_docusaurus_github_io||[]).push([[9502],{6480:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>m,default:()=>p,frontMatter:()=>c,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"ladle/implement-preview","title":"Resizable Preview","description":"Ladle helps in preview of components. If you are building a component library and you want help showing previews of components, Ladle can help you.","source":"@site/docs/ladle/implement-preview.mdx","sourceDirName":"ladle","slug":"/ladle/implement-preview","permalink":"/docs/ladle/implement-preview","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/ladle/implement-preview.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docSidebar","previous":{"title":"Integrate Ladle","permalink":"/docs/ladle/integrate-ladle"}}');var s=t(4848),a=t(8453),i=t(9443);const l='"use client";\n\nimport React, { useState } from "react";\nimport clsx from "clsx";\nimport { motion, useTransform, useMotionValue } from "framer-motion";\nimport { useEffect, useRef } from "react";\nimport { useColorMode } from "@docusaurus/theme-common";\n\nlet paddingMap = { none: "", md: "p-2" };\n\nconst getLadleUrl = (story) => {\n  const isDevelopment = process.env.NODE_ENV === "development";\n  if (isDevelopment) {\n    return `http://localhost:61000/ladle?story=${story}&mode=preview`;\n  }\n  return `/ladle?mode=preview&story=${story}`;\n};\n\ntype WellProps = {\n  as?: React.ElementType;\n  story: string;\n  height: number;\n  iframePointerEvents: any;\n  style?: React.CSSProperties;\n  padding?: string;\n  p?: string;\n  className?: string;\n  containerClassName?: string;\n  html?: string;\n  children?: React.ReactNode;\n  hint?: string;\n  hintClassName?: string;\n  lightOnly?: boolean;\n};\n\nfunction Well({\n  as: Component = "div",\n  story,\n  height,\n  iframePointerEvents,\n  style,\n  padding,\n  p = "md",\n  className,\n  containerClassName,\n  html,\n  children,\n  hint,\n  hintClassName,\n  lightOnly = false,\n}: WellProps) {\n  let paddingKey = padding ?? p;\n  let paddingClassName = paddingMap[paddingKey];\n  const iframeUrl = getLadleUrl(story);\n  const { colorMode, setColorMode } = useColorMode();\n\n  useEffect(() => {\n    const updateIframeTheme = (theme) => {\n      const iframe = document.querySelector("iframe");\n      if (iframe && iframe.contentDocument) {\n        iframe.contentDocument.documentElement.setAttribute(\n          "data-theme",\n          theme\n        );\n      }\n    };\n\n    updateIframeTheme(colorMode);\n  }, [colorMode]);\n\n  if (paddingClassName === undefined) {\n    throw Error(`Invalid padding value: ${JSON.stringify(paddingKey)}`);\n  }\n\n  return (\n    <div className={containerClassName}>\n      <Component\n        style={style}\n        className={clsx(\n          "not-prose relative bg-slate-50 rounded-md overflow-hidden",\n          !lightOnly && "dark:bg-slate-800/25"\n        )}\n      >\n        <div\n          style={{ backgroundPosition: "10px 10px" }}\n          className={clsx(\n            "absolute inset-0 bg-grid-slate-100 [mask-image:linear-gradient(0deg,#fff,rgba(255,255,255,0.6))]",\n            !lightOnly &&\n              "dark:bg-grid-slate-700/25 dark:[mask-image:linear-gradient(0deg,rgba(255,255,255,0.1),rgba(255,255,255,0.5))]"\n          )}\n        />\n        <div\n          className={clsx(\n            "relative border rounded-md border-gray-200 border-dashed dark:border-gray-700 !overflow-hidden",\n            paddingClassName,\n            className\n          )}\n        >\n          <motion.iframe\n            id="my-iframe"\n            className="w-full"\n            src={iframeUrl}\n            height={height}\n            allow="cross-origin-isolated"\n            style={{ pointerEvents: iframePointerEvents }}\n          />\n        </div>\n\n        <div\n          className={clsx(\n            "absolute inset-0 pointer-events-none border border-black/5",\n            !lightOnly && "dark:border-white/5"\n          )}\n        />\n      </Component>\n    </div>\n  );\n}\n\nconst ResizableLadlePreview = ({ story, initialWidth = 800, height = 720 }) => {\n  let containerRef = useRef();\n  let x = useMotionValue(0);\n  let constraintsRef = useRef();\n  let handleRef = useRef<HTMLDivElement>(null);\n  let iframePointerEvents = useMotionValue("auto");\n\n  useEffect(() => {\n    const observer = new window.ResizeObserver(() => {\n      x.set(0);\n    });\n    observer.observe(containerRef.current);\n    return () => {\n      observer.disconnect();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (handleRef.current) {\n      handleRef.current.onselectstart = () => false;\n    }\n  }, []);\n\n  return (\n    <div ref={containerRef} className="relative twp">\n      <Well\n        as={motion.div}\n        style={{ marginRight: useTransform(x, (x) => -x) }}\n        story={story}\n        height={height}\n        iframePointerEvents={iframePointerEvents}\n      />\n\n      <div\n        ref={constraintsRef}\n        className="absolute inset-y-0 right-[-1.375rem] left-80 ml-4 pointer-events-none"\n      >\n        <motion.div\n          ref={handleRef}\n          drag="x"\n          _dragX={x}\n          dragMomentum={false}\n          dragElastic={0}\n          dragConstraints={constraintsRef}\n          className="absolute right-0 inset-y-0 hidden p-3 pointer-events-auto  md:block cursor-ew-resize"\n          style={{ x }}\n          onDragStart={() => {\n            document.documentElement.classList.add("dragging-ew");\n            iframePointerEvents.set("none");\n          }}\n          onDragEnd={() => {\n            document.documentElement.classList.remove("dragging-ew");\n            iframePointerEvents.set("auto");\n          }}\n        >\n          <div\n            className="absolute top-1/2 w-1.5 h-8 bg-slate-500/60 rounded-full -translate-x-1/2 left-1/2"\n            style={{\n              transform: "translateX(-3px)",\n            }}\n          />\n        </motion.div>\n      </div>\n    </div>\n  );\n};\n\nexport default ResizableLadlePreview;\n',o='export const World = () => (\n  <p className="bg-red-200 md:bg-blue-200 m-6 p-6 dark:md:bg-green-200">\n    Hello World\n  </p>\n);\n';var d=t(1432);const c={sidebar_position:2},m="Resizable Preview",u={},h=[{value:"Add ResizableLadlePreview.tsx",id:"add-resizableladlepreviewtsx",level:2},{value:"Test Preview",id:"test-preview",level:2},{value:"Add Hello World Story",id:"add-hello-world-story",level:3},{value:"Run Ladle",id:"run-ladle",level:3},{value:"Example Story with Preview",id:"example-story-with-preview",level:3}];function g(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"resizable-preview",children:"Resizable Preview"})}),"\n",(0,s.jsx)(n.p,{children:"Ladle helps in preview of components. If you are building a component library and you want help showing previews of components, Ladle can help you."}),"\n",(0,s.jsx)(n.h2,{id:"add-resizableladlepreviewtsx",children:"Add ResizableLadlePreview.tsx"}),"\n",(0,s.jsx)(d.A,{title:"src/components/ResizableLadlePreview.tsx",language:"tsx",children:l}),"\n",(0,s.jsx)(n.h2,{id:"test-preview",children:"Test Preview"}),"\n",(0,s.jsx)(n.h3,{id:"add-hello-world-story",children:"Add Hello World Story"}),"\n",(0,s.jsx)(d.A,{title:"src/stories/hello.stories.tsx",language:"tsx",children:o}),"\n",(0,s.jsx)(n.h3,{id:"run-ladle",children:"Run Ladle"}),"\n",(0,s.jsx)(n.p,{children:"For following to work during development. Keep both commands running:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run start\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run ladle:serve\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-story-with-preview",children:"Example Story with Preview"}),"\n",(0,s.jsx)(n.p,{children:"In any .mdx file of docusaurus add following The components loads ladle preview of a story in an iframe which is resizable."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'import ResizableLadlePreview from "@site/src/components/ResizableLadlePreview";\n<ResizableLadlePreview story="hello--world" height={200} />;\n'})}),"\n",(0,s.jsx)(n.p,{children:"It should show up like following:"}),"\n",(0,s.jsx)(i.A,{story:"hello--world",height:200}),"\n",(0,s.jsx)(i.A,{story:"page--world",height:600})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(g,{...e})}):g(e)}},9443:(e,n,t)=>{t.d(n,{A:()=>u});var r=t(6540),s=t(4164),a=t(8504),i=t(3295),l=t(3296),o=t(5293),d=t(4848);let c={none:"",md:"p-2"};function m(e){let{as:n="div",story:t,height:i,iframePointerEvents:l,style:m,padding:u,p:h="md",className:g,containerClassName:p,html:f,children:v,hint:b,hintClassName:w,lightOnly:y=!1}=e,x=u??h,N=c[x];const R=(e=>`/ladle?mode=preview&story=${e}`)(t),{colorMode:E,setColorMode:j}=(0,o.G)();if((0,r.useEffect)((()=>{(e=>{const n=document.querySelector("iframe");n&&n.contentDocument&&n.contentDocument.documentElement.setAttribute("data-theme",e)})(E)}),[E]),void 0===N)throw Error(`Invalid padding value: ${JSON.stringify(x)}`);return(0,d.jsx)("div",{className:p,children:(0,d.jsxs)(n,{style:m,className:(0,s.A)("not-prose relative bg-slate-50 rounded-md overflow-hidden",!y&&"dark:bg-slate-800/25"),children:[(0,d.jsx)("div",{style:{backgroundPosition:"10px 10px"},className:(0,s.A)("absolute inset-0 bg-grid-slate-100 [mask-image:linear-gradient(0deg,#fff,rgba(255,255,255,0.6))]",!y&&"dark:bg-grid-slate-700/25 dark:[mask-image:linear-gradient(0deg,rgba(255,255,255,0.1),rgba(255,255,255,0.5))]")}),(0,d.jsx)("div",{className:(0,s.A)("relative border rounded-md border-gray-200 border-dashed dark:border-gray-700 !overflow-hidden",N,g),children:(0,d.jsx)(a.P.iframe,{id:"my-iframe",className:"w-full",src:R,height:i,allow:"cross-origin-isolated",style:{pointerEvents:l}})}),(0,d.jsx)("div",{className:(0,s.A)("absolute inset-0 pointer-events-none border border-black/5",!y&&"dark:border-white/5")})]})})}const u=e=>{let{story:n,initialWidth:t=800,height:s=720}=e,o=(0,r.useRef)(),c=(0,i.d)(0),u=(0,r.useRef)(),h=(0,r.useRef)(null),g=(0,i.d)("auto");return(0,r.useEffect)((()=>{const e=new window.ResizeObserver((()=>{c.set(0)}));return e.observe(o.current),()=>{e.disconnect()}}),[]),(0,r.useEffect)((()=>{h.current&&(h.current.onselectstart=()=>!1)}),[]),(0,d.jsxs)("div",{ref:o,className:"relative twp",children:[(0,d.jsx)(m,{as:a.P.div,style:{marginRight:(0,l.G)(c,(e=>-e))},story:n,height:s,iframePointerEvents:g}),(0,d.jsx)("div",{ref:u,className:"absolute inset-y-0 right-[-1.375rem] left-80 ml-4 pointer-events-none",children:(0,d.jsx)(a.P.div,{ref:h,drag:"x",_dragX:c,dragMomentum:!1,dragElastic:0,dragConstraints:u,className:"absolute right-0 inset-y-0 hidden p-3 pointer-events-auto  md:block cursor-ew-resize",style:{x:c},onDragStart:()=>{document.documentElement.classList.add("dragging-ew"),g.set("none")},onDragEnd:()=>{document.documentElement.classList.remove("dragging-ew"),g.set("auto")},children:(0,d.jsx)("div",{className:"absolute top-1/2 w-1.5 h-8 bg-slate-500/60 rounded-full -translate-x-1/2 left-1/2",style:{transform:"translateX(-3px)"}})})})]})}}}]);